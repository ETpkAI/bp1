server {
    listen 80;
    server_name localhost;

    # The root directory where our app files are stored
    root /usr/share/nginx/html;

    # The default file to serve
    index index.html;

    # --- Custom Error Pages ---
    # Redirect server-side errors to a user-friendly page
    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        internal;
    }
    # Redirect not-found errors to a user-friendly page
    error_page 404 /404.html;
    location = /404.html {
        internal;
    }

    # --- SPA Routing ---
    # Required for single-page applications (SPA) like React.
    # It tries to find a file matching the URI, and if it doesn't exist,
    # it serves index.html to let React Router handle the route.
    location / {
        try_files $uri $uri/ /index.html;
    }

    # --- Security Headers ---
    add_header X-Frame-Options "SAMEORIGIN";
    add_header X-Content-Type-Options "nosniff";
    add_header Referrer-Policy "no-referrer";
    add_header X-XSS-Protection "1; mode=block";

    # --- MIME Types ---
    # Add MIME types for our specific file extensions to ensure they are served correctly.
    types {
        text/html                             html htm shtml;
        text/css                              css;
        application/javascript                js tsx; # Serve .tsx files as javascript
        application/json                      json;
        image/gif                             gif;
        image/jpeg                            jpeg jpg;
        image/png                             png;
        image/svg+xml                         svg;
    }
}